<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Document</title>
	<link rel="stylesheet" type="text/css"
		src="/assets/salesforce-lightning-design-system-2.13.7/assets/styles/salesforce-lightning-design-system.css" />
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/design-system/2.13.7/styles/salesforce-lightning-design-system.min.css"
		integrity="sha512-UV/bdfkf/vUvwZ6/aVq8zas293BNyu43i68QdurkfUmSjGRiCxKISDe29R6VPB3YKfeA/lCjGyfXLBIzlpTg5A=="
		crossorigin="anonymous" />
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/design-system/2.13.7/styles/salesforce-lightning-design-system.sanitized.min.css"
		integrity="sha512-O9RC97AHIeSWK6mAA/b1GBPzrBsmNBT8nN2yz6vghHn0Eatt4P7ilv4H+uO5mp7WIDh9sKbUoKSg3pGsPM8ShA=="
		crossorigin="anonymous" />
	<link rel="stylesheet"
		href="https://cdnjs.cloudflare.com/ajax/libs/design-system/2.13.7/styles/salesforce-lightning-design-system_touch.min.css"
		integrity="sha512-5j2QXzkr/ZIuvsLKYgRr8HEfAx5D+Mg0dFDCSGwKR2GKcdZbJSynKdirYGVGRVWLz9ryxV4/0kfoCGffJD3fQw=="
		crossorigin="anonymous" />
	<link rel="stylesheet" type="text/css"
		src="/assets/salesforce-lightning-design-system-2.13.7/assets/styles/salesforce-lightning-design-system.css" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta charset="UTF-8">
	<!-- CSS only -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
	<!-- JavaScript Bundle with Popper -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
		crossorigin="anonymous"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="js/jquery.easing.min.js" type="text/javascript"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
	<script src="https://code.jquery.com/jquery-3.3.1.min.js"
		integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
</head>

<body>

	<a
		href="https://mc6vgk-sxj9p08pqwxqz9hw9-4my.auth.marketingcloudapis.com/v2/authorize?response_type=code&client_id=4b3a1hyqartrnbu0fjw4c7y1&redirect_uri=https://sfmc-slack-app.herokuapp.com/&scope=email_read%20email_write%20email_send&state=mystate">
		Sign In</a>


	<button onclick="getParameters()">
		Get URL parameters
	</button>


</body>
<script>
	function getParameters() {
		let urlString = window.location.href;
		console.log('Current url ' + urlString);
		let paramString = urlString.split('?')[1];
		let authCode;
		let queryString = new URLSearchParams(paramString);

		for (let pair of queryString.entries()) {
			console.log("Key is:" + pair[0]);
			console.log("Value is:" + pair[1]);
			authCode = pair[1];
		}
		//document.getElementById("urlButton").value = authCode;
		//var payload = {"code":authCode,"clientId":"4b3a1hyqartrnbu0fjw4c7y1","clientSecret":"zRWL2uqxxIsRA9BWU6zdcPes","authUrl":"https://mc6vgk-sxj9p08pqwxqz9hw9-4my.auth.marketingcloudapis.com"};

		//console.log('Payload '+payload);

		$.ajax({
			url: '/validatequery',
			data: {
				'code': "authCode",
				'clientId': '4b3a1hyqartrnbu0fjw4c7y1',
				'clientSecret': 'zRWL2uqxxIsRA9BWU6zdcPes',
				'authUrl': 'https://mc6vgk-sxj9p08pqwxqz9hw9-4my.auth.marketingcloudapis.com'
			},
			type: "POST",
			headers: {
				'Content-type': 'application/x-www-form-urlencoded'
			},
			success: function (data) {

			}
		});


		/*	$.ajax({
				url: '/credential',
				type: 'POST',
				dataType:'JSON',
				contentType:'application/x-www-form-urlencoded',
				data:JSON.stringify({
					'code':authCode,
					'clientId':'4b3a1hyqartrnbu0fjw4c7y1',
					'clientSecret':'zRWL2uqxxIsRA9BWU6zdcPes',
					'authUrl':'https://mc6vgk-sxj9p08pqwxqz9hw9-4my.auth.marketingcloudapis.com'
				}),
				success: function(data) {
				   console.log(data);
				   
				}
			});*/
	}
</script>

</html>